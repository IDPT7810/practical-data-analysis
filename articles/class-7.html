<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Class 7: Iteration â€¢ pbda</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Class 7: Iteration">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pbda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Class Material
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/class-1.html">Class 1: Overview, Data Import and Tidying</a>
    </li>
    <li>
      <a href="../articles/class-2.html">Class 2: Analyzing qPCR data</a>
    </li>
    <li>
      <a href="../articles/class-5.html">Class 5: Basic Data Types and Structures</a>
    </li>
    <li>
      <a href="../articles/class-5.html">Class 5: Gene List Handling</a>
    </li>
    <li>
      <a href="../articles/class-6.html">Class 6: Writing Functions</a>
    </li>
    <li>
      <a href="../articles/class-7.html">Class 7: Iteration</a>
    </li>
    <li>
      <a href="../articles/class-8.html">Class 8: Heatmaps and Clustering</a>
    </li>
    <li>
      <a href="../articles/class-9.html">Class 9: Exploring data with PCA</a>
    </li>
    <li>
      <a href="../articles/class-12.html">Class 12: Jumping into more complex R, tips, resources</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/assignments.html">Assignment Submission and Grading Rubric</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rnabioco/practical-data-analysis">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Class 7: Iteration</h1>
                        <h4 class="author">Ryan Sheridan</h4>
            
            <h4 class="date">2019-12-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rnabioco/practical-data-analysis/blob/master/vignettes/class-7.Rmd"><code>vignettes/class-7.Rmd</code></a></small>
      <div class="hidden name"><code>class-7.Rmd</code></div>

    </div>

    
    
<p><br></p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>As discussed in the previous class, you should try to limit duplication in your code. One way to do this is by writing functions, another way is through iteration. Reducing code duplication has several benefits:</p>
<ul>
<li>Your code easier to read</li>
<li>You reduce the chance of mistakes from repeated copying and pasting</li>
<li>It is easier to adapt your code for different requirements</li>
</ul>
<p>Further reading</p>
<ul>
<li>
<a href="https://r4ds.had.co.nz">R for Data Science</a> by Garrett Grolemund and Hadley Wickham</li>
<li>
<a href="https://adv-r.hadley.nz">Advanced R</a> by Hadley Wickham</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(pbda)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(cowplot)</a></code></pre></div>
<p><br></p>
<p><br></p>
</div>
<div id="for-loops" class="section level2">
<h2 class="hasAnchor">
<a href="#for-loops" class="anchor"></a><code>for</code> loops</h2>
<p><code>for</code> loops allow you to run the same code block repeatedly without copying and pasting.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># When writing a for loop, think about the output, sequence, and body</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">out &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"numeric"</span>, <span class="dv">5</span>)  <span class="co"># output</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(out)) {   <span class="co"># sequence</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  out[i] &lt;-<span class="st"> </span>i <span class="op">*</span><span class="st"> </span><span class="dv">5</span>            <span class="co"># body</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb2-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># It's helpful to think about what happens during each cycle of the loop</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">out[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>  <span class="co"># i = 1</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">out[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>  <span class="co"># i = 2</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">out[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>  <span class="co"># i = 3</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">out[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>  <span class="co"># i = 4</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">out[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>  <span class="co"># i = 5</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Lets use rnorm() to create 5 vectors with different values for 'mean'</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># One way to do this is by copying and pasting</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">vec_in &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">70</span>)                <span class="co"># input</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">out &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(vec_in))        <span class="co"># output</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">out[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> vec_in[<span class="dv">1</span>])    </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">out[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> vec_in[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">out[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> vec_in[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">out[[<span class="dv">4</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> vec_in[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">out[[<span class="dv">5</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> vec_in[<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co"># Use a for loop to reduce code duplication</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">vec_in &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">70</span>)                  <span class="co"># input</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">out &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(vec_in))          <span class="co"># output</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(vec_in)) {                  <span class="co"># sequence</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">  </a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  out[[i]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> vec_in[i])  <span class="co"># body</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21">  </a>
<a class="sourceLine" id="cb3-22" data-line-number="22">}</a></code></pre></div>
<p><br></p>
<p><em>Write a <code>for</code> loop to create 3 vectors of different lengths</em></p>
<pre><code>#&gt; [[1]]
#&gt; [1] -0.4057548 -0.6745024 -0.1480940 -0.4092698 -2.5724227
#&gt; 
#&gt; [[2]]
#&gt;  [1] -0.4454368 -0.1984907  0.9551669  0.7756078  0.5509789  0.9482095
#&gt;  [7] -1.0917559 -0.6593295 -0.4984677 -1.0529355
#&gt; 
#&gt; [[3]]
#&gt; [1] 0.02931056 0.75606290</code></pre>
<p><br></p>
<p>Using <code><a href="https://rdrr.io/r/base/seq.html">seq_along(x)</a></code> instead of <code>1:length(x)</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># seq_along() mimics 1:length() for non-empty vectors</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">vec_in &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(vec_in)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; [1] 1 2 3</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(vec_in)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [1] 1 2 3</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co"># seq_along() correctly handles empty vectors</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">emp_vec &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"numeric"</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(emp_vec)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; [1] 1 0</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(emp_vec)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; integer(0)</span></a></code></pre></div>
<p><br></p>
<p><br></p>
</div>
<div id="using-the-brauer-data" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-brauer-data" class="anchor"></a>Using the Brauer data</h2>
<p>Using the Brauer gene expression data lets create a figure showing the growth rate vs expression for four genes</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># This is the function we wrote in class-6</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">plot_expr &lt;-<span class="st"> </span><span class="cf">function</span>(input, sys_name, ...) {</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  gg_data &lt;-<span class="st"> </span>input <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(systematic_name <span class="op">==</span><span class="st"> </span>sys_name)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  plot_title &lt;-<span class="st"> </span>gg_data<span class="op">$</span>name[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  plot_sub &lt;-<span class="st"> </span>gg_data<span class="op">$</span>MF[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  gg_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(rate, expression, <span class="dt">color =</span> nutrient)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="st">    </span><span class="kw">geom_point</span>(...) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> plot_title, <span class="dt">subtitle =</span> plot_sub) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>nutrient) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/theme_cowplot.html">theme_cowplot</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>)</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb6-18" data-line-number="18"></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co"># Lets try this with the copy-and-paste method</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20">vec_in &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"YDL104C"</span>, <span class="st">"YLR115W"</span>, <span class="st">"YMR183C"</span>, <span class="st">"YML017W"</span>)       <span class="co"># input</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"></a>
<a class="sourceLine" id="cb6-22" data-line-number="22">out &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(vec_in))                         <span class="co"># output </span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"></a>
<a class="sourceLine" id="cb6-24" data-line-number="24">out[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">plot_expr</span>(brauer_gene_exp, <span class="dt">sys_name =</span> vec_in[<span class="dv">1</span>])  </a>
<a class="sourceLine" id="cb6-25" data-line-number="25">out[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">plot_expr</span>(brauer_gene_exp, <span class="dt">sys_name =</span> vec_in[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">out[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">plot_expr</span>(brauer_gene_exp, <span class="dt">sys_name =</span> vec_in[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb6-27" data-line-number="27">out[[<span class="dv">4</span>]] &lt;-<span class="st"> </span><span class="kw">plot_expr</span>(brauer_gene_exp, <span class="dt">sys_name =</span> vec_in[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb6-28" data-line-number="28"></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="dt">plotlist =</span> out)</a></code></pre></div>
<p><img src="class-7_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><br></p>
<p><em>Re-write the code from above using a <code>for</code> loop to generate our figure</em></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">vec_in &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"YDL104C"</span>, <span class="st">"YLR115W"</span>, <span class="st">"YMR183C"</span>, <span class="st">"YML017W"</span>)  <span class="co"># input</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">out &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(vec_in))                    <span class="co"># output</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="cf">for</span> ( ???? ) {                                           <span class="co"># sequence</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                                                         <span class="co"># body</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="dt">plotlist =</span> out)</a></code></pre></div>
<p><br></p>
<p><br></p>
</div>
<div id="introduction-to-map" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction-to-map" class="anchor"></a>Introduction to <code>map()</code>
</h2>
<p><code>for</code> loops are a powerful tool to reduce code duplication, however your code can be further simplified using the <code>map()</code> functions provided in the purrr package. These <code>map()</code> functions essentially run <code>for (i in seq_along(x))</code> behind the scenes so you donâ€™t have to explicitly type this.</p>
<p>There is a function for each type of output:</p>
<ul>
<li>
<code>map()</code> makes a list</li>
<li>
<code>map_lgl()</code> makes a logical vector</li>
<li>
<code>map_int()</code> makes an integer vector</li>
<li>
<code>map_dbl()</code> makes a double vector</li>
<li>
<code>map_chr()</code> makes a character vector</li>
</ul>
<p>Each <code>map()</code> function requires two inputs: <code>map(.x, .f, ...)</code></p>
<ul>
<li>
<code>.x</code> is a list or atomic vector</li>
<li>
<code>.f</code> is a function or formula</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># We previously used a for loop to create vectors with different values for mean</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">vals &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">70</span>)                  <span class="co"># input</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">out &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(vals))          <span class="co"># output</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(vals)) {                 <span class="co"># sequence</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb8-8" data-line-number="8">  out[[i]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> vals[i])  <span class="co"># body</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb8-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co"># Using map() we can further simplify this code</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co"># .x indicates where each element of the vector should be inserted</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14">out &lt;-<span class="st"> </span><span class="kw">map</span>(</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">  <span class="dt">.x =</span> vals,</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">  <span class="dt">.f =</span> <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> .x)</a>
<a class="sourceLine" id="cb8-17" data-line-number="17">)</a>
<a class="sourceLine" id="cb8-18" data-line-number="18"></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co"># You can use brackets to include a multi-line code block</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20">out &lt;-<span class="st"> </span><span class="kw">map</span>(vals, <span class="op">~</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">  </a>
<a class="sourceLine" id="cb8-22" data-line-number="22">  <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> .x)</a>
<a class="sourceLine" id="cb8-23" data-line-number="23"></a>
<a class="sourceLine" id="cb8-24" data-line-number="24">})</a>
<a class="sourceLine" id="cb8-25" data-line-number="25"></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co"># map() allows for very readable code</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co"># Each element of the vector is passed to the first available argument</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28">out &lt;-<span class="st"> </span><span class="kw">map</span>(vals, rnorm, <span class="dt">n =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><br></p>
<p><em>Use <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> and <code>map()</code> to create 3 vectors of different lengths</em></p>
<pre><code>#&gt; [[1]]
#&gt; [1]  0.2068064  0.6638498 -0.1988099 -0.3257463  1.4674639
#&gt; 
#&gt; [[2]]
#&gt;  [1] -0.2046594 -0.3108961 -0.2164058  0.7519694 -0.5663685  2.0023858
#&gt;  [7]  1.2957174  0.9505907 -2.3565995  0.5417138
#&gt; 
#&gt; [[3]]
#&gt; [1] -0.2069461  0.4191227</code></pre>
<p><br></p>
<p><em>Re-write the code from above using <code>map()</code> to generate our growth rate figure</em></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"YDL104C"</span>, <span class="st">"YOR069W"</span>, <span class="st">"YLR115W"</span>, <span class="st">"YPR036W"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">expr_plots &lt;-<span class="st"> </span><span class="kw">map</span>(</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  ????</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb10-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="dt">plotlist =</span> expr_plots)</a></code></pre></div>
<p><img src="class-7_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><br></p>
<p><br></p>
</div>
<div id="mapping-over-multiple-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#mapping-over-multiple-arguments" class="anchor"></a>Mapping over multiple arguments</h2>
<p>If you have two vectors containing values that you want to pass to a function this can be accomplished with <code>map2()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"YDL104C"</span>, <span class="st">"YOR069W"</span>, <span class="st">"YLR115W"</span>, <span class="st">"YPR036W"</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">shapes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">expr_plots &lt;-<span class="st"> </span><span class="kw">map2</span>(genes, shapes, <span class="op">~</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="kw">plot_expr</span>(</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">    <span class="dt">input    =</span> brauer_gene_exp,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">    <span class="dt">sys_name =</span> .x,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">    <span class="dt">shape    =</span> .y</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">})</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="dt">plotlist =</span> expr_plots)</a></code></pre></div>
<p><img src="class-7_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><br></p>
<p><em>Use <code>map2()</code> to create plots for 4 different genes, each with a different point size</em></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"YDL104C"</span>, <span class="st">"YOR069W"</span>, <span class="st">"YLR115W"</span>, <span class="st">"YPR036W"</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">expr_plots &lt;-<span class="st"> </span><span class="kw">map2</span>(</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb12-5" data-line-number="5">  ????</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb12-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="dt">plotlist =</span> expr_plots)</a></code></pre></div>
<p><img src="class-7_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><br></p>
<p><code>pmap</code> can be used to map over any number of arguments.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Create a list of input vectors</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"YDL104C"</span>, <span class="st">"YOR069W"</span>, <span class="st">"YLR115W"</span>, <span class="st">"YPR036W"</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">sizes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">shapes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"></a>
<a class="sourceLine" id="cb13-6" data-line-number="6">plot_args &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(genes, sizes, shapes)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co"># Use an argument list with pmap</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">expr_plots &lt;-<span class="st"> </span><span class="kw">pmap</span>(plot_args, <span class="op">~</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">  <span class="kw">plot_expr</span>(</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">    <span class="dt">input =</span> brauer_gene_exp,</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">    <span class="dt">sys_name =</span> ..<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">    <span class="dt">size     =</span> ..<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">    <span class="dt">shape    =</span> ..<span class="dv">3</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15">  )</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">})</a>
<a class="sourceLine" id="cb13-17" data-line-number="17"></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co"># A simpler way</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19">plot_args &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb13-20" data-line-number="20">  <span class="dt">sys_name =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"YDL104C"</span>, <span class="st">"YOR069W"</span>, <span class="st">"YLR115W"</span>, <span class="st">"YPR036W"</span>),</a>
<a class="sourceLine" id="cb13-21" data-line-number="21">  <span class="dt">size     =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>),</a>
<a class="sourceLine" id="cb13-22" data-line-number="22">  <span class="dt">shape    =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-23" data-line-number="23">)</a>
<a class="sourceLine" id="cb13-24" data-line-number="24"></a>
<a class="sourceLine" id="cb13-25" data-line-number="25">expr_plots &lt;-<span class="st"> </span><span class="kw">pmap</span>(</a>
<a class="sourceLine" id="cb13-26" data-line-number="26">  <span class="dt">.l =</span> plot_args, </a>
<a class="sourceLine" id="cb13-27" data-line-number="27">  <span class="dt">.f =</span> plot_expr, </a>
<a class="sourceLine" id="cb13-28" data-line-number="28">  <span class="dt">input =</span> brauer_gene_exp</a>
<a class="sourceLine" id="cb13-29" data-line-number="29">)</a>
<a class="sourceLine" id="cb13-30" data-line-number="30"></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="kw"><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">plot_grid</a></span>(<span class="dt">plotlist =</span> expr_plots)</a></code></pre></div>
<p><img src="class-7_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto auto auto 0;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#for-loops"><code>for</code> loops</a></li>
      <li><a href="#using-the-brauer-data">Using the Brauer data</a></li>
      <li><a href="#introduction-to-map">Introduction to <code>map()</code></a></li>
      <li><a href="#mapping-over-multiple-arguments">Mapping over multiple arguments</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://hesselberthlab.org">Jay Hesselberth</a>, Austin Gillen, Kent Riemondy, Rui Fu, Ryan Sheridan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
