<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Class 4: Genomic Interval Analysis part 1 • eda</title>
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Class 4: Genomic Interval Analysis part 1">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-54095998-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-54095998-4');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eda</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Class Material
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/class-1.html">Class 1: Overview and Data Tidying</a>
    </li>
    <li>
      <a href="../articles/class-2.html">Class 2: Writing Reproducible Reports</a>
    </li>
    <li>
      <a href="../articles/class-3.html">Class 3: Common Analysis Challenges</a>
    </li>
    <li>
      <a href="../articles/class-4.html">Class 4: Genomic Interval Analysis part 1</a>
    </li>
    <li>
      <a href="../articles/class-5.html">Class 5: Genomic Interval Analysis part 2</a>
    </li>
    <li>
      <a href="../articles/class-6.html">Class 6: RNA-Seq Analysis part 1</a>
    </li>
    <li>
      <a href="../articles/class-7.html">Class 7: RNA-Seq Analysis part 2</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/exercises-1.html">Exercises 1</a>
    </li>
    <li>
      <a href="../articles/exercises-2.html">Exercises 2</a>
    </li>
    <li>
      <a href="../articles/exercises-3.html">Exercises 3</a>
    </li>
    <li>
      <a href="../articles/exercises-4.html">Exercises 4</a>
    </li>
    <li>
      <a href="../articles/exercises-5.html">Exercises 5</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/assignment-1.html">Weekend Assignment 1</a>
    </li>
    <li>
      <a href="../articles/assignment-2.html">Weekend Assignment 2</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/assignments.html">Assignment Submission and Grading Rubric</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Class 4: Genomic Interval Analysis part 1</h1>
                        <h4 class="author">Jay Hesselberth</h4>
            
            <h4 class="date">2018-11-08</h4>
      
      
      <div class="hidden name"><code>class-4.Rmd</code></div>

    </div>

    
    
<div id="genomic-interval-data" class="section level1">
<h1 class="hasAnchor">
<a href="#genomic-interval-data" class="anchor"></a>Genomic Interval Data</h1>
<ul>
<li>Introduce genome-wide data with the UCSC genome browser and ENCODE chromatin data</li>
<li>Summarizing genomic datatsets as intervals and signals</li>
<li>Intersecting gene models, SNP databases, and Chip-Seq data</li>
</ul>
</div>
<div id="visualizing-genomics-data-with-the-ucsc-genome-browser" class="section level1">
<h1 class="hasAnchor">
<a href="#visualizing-genomics-data-with-the-ucsc-genome-browser" class="anchor"></a>Visualizing genomics data with the UCSC genome browser</h1>
<p>The <a href="http://genome.ucsc.edu/index.html">UCSC genome browser</a> provides a web interface for viewing, downloading, and querying genomics data. Numerous datasets are available to view, including:</p>
<ol style="list-style-type: decimal">
<li>Gene annotations (<a href="http://www.gencodegenes.org/releases/current.html">GENCODE</a>)</li>
<li>Gene expression data (<a href="https://gtexportal.org/home/">GTEx</a>)</li>
<li>SNP databases (<a href="http://www.internationalgenome.org/home">1000 genomes</a>)</li>
<li>Functional genomics data (<a href="https://www.encodeproject.org/">ENCODE</a>)</li>
<li>User-uploaded datasets</li>
</ol>
</div>
<div id="genomics-data-summarizes-to-intervals" class="section level1">
<h1 class="hasAnchor">
<a href="#genomics-data-summarizes-to-intervals" class="anchor"></a>Genomics data summarizes to intervals</h1>
<p>The genome can be described as a coordinate system:</p>
<p><img src="img/class-4-karyotype.png"></p>
<div id="nucleotides-are-represented-in-1-d-positional-coordinates" class="section level2">
<h2 class="hasAnchor">
<a href="#nucleotides-are-represented-in-1-d-positional-coordinates" class="anchor"></a>Nucleotides are represented in 1-D positional coordinates:</h2>
<pre><code>chr1 ATGCTAGCTGATCGTAGCTG...
     0123456789...
     
chr2 ATGCTAGCTGATCGTAGCTG...
     0123456789...
     
chr3 ATGCTAGCTGATCGTAGCTG...
     0123456789...    </code></pre>
</div>
<div id="intervals-describe-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#intervals-describe-regions" class="anchor"></a>Intervals describe regions</h2>
<pre><code>chr1 ATGCTAGCTGATCGTAGCTG...

# first 20 nucleotides
#chrom  start end
chr1    0     20

# whole chromosomes
chr1  0 249250621
chr2  0 243199373
chr3  0 198022430</code></pre>
</div>
<div id="read-alignments-are-intervals" class="section level2">
<h2 class="hasAnchor">
<a href="#read-alignments-are-intervals" class="anchor"></a>Read alignments are intervals</h2>
<p>After aligning genomics data, each alignment can be represented as an interval covering a particular genomic sequence.</p>
<pre><code>read 1:           ------            
read 2:     -----  
read 3:    ----
      chr1 ATGCTAGCTGATCGTAGCTG...
      
      
chr1  0   4
chr1  1   6
chr1  7   13</code></pre>
</div>
</div>
<div id="bed-format" class="section level1">
<h1 class="hasAnchor">
<a href="#bed-format" class="anchor"></a>BED format</h1>
<p>The <a href="https://genome.ucsc.edu/FAQ/FAQformat#format1"><code>BED</code></a> file format defines genomic regions of interest:</p>
<pre><code>#BED3 (3-columns)

#chrom start end
chr1   0     4
chr1   1     6
chr1   7     13</code></pre>
<p>and can define genomic features of interest:</p>
<ul>
<li>read alignments</li>
<li>gene coordinates</li>
<li>positions of genetic variation (i.e. SNPs, indels)</li>
</ul>
<pre><code>#BED6
#chrom start end name  score strand

chr1  0  4  ELAVL1_binding_site 100.00  +
chr1  1  6  microRNA            10      -
chr1  7  13 alternative_exon    1       .

interval 1:       -----&gt;            
interval 2:  &lt;----  
interval 3:&lt;--&gt;
      chr1:ATGCTAGCTGATCGTAGCTG...
</code></pre>
</div>
<div id="obtaining-interval-data" class="section level1">
<h1 class="hasAnchor">
<a href="#obtaining-interval-data" class="anchor"></a>Obtaining interval data</h1>
<p><code>BED</code> files can be downloaded from many sources:</p>
<ol style="list-style-type: decimal">
<li><p>The <a href="https://genome.ucsc.edu/cgi-bin/hgTables">UCSC table browser</a> provides an easy interface for downloading many types of genomic data as <code>BED</code> (and other) format files.</p></li>
<li><p>The ENCODE project provides a data access portal to download experimental data from numerous types of high-throughput experiments (<code>BED</code> files <a href="https://www.encodeproject.org/matrix/?type=Experiment&amp;files.file_type=bed+narrowPeak">here</a>).</p></li>
</ol>
<div id="bedgraph-files-define-genomic-signals" class="section level2">
<h2 class="hasAnchor">
<a href="#bedgraph-files-define-genomic-signals" class="anchor"></a>Bedgraph files define genomic signals</h2>
<p>The <a href="https://genome.ucsc.edu/goldenPath/help/bedgraph.html"><code>bedGraph</code></a> format is an extension of the <code>BED</code> format commonly used to summarize single nucleotide read coverage from <code>ChIP-Seq</code>, <code>CLIP-Seq</code>, <code>mRNA-Seq</code>, and other genome-wide data.</p>
<pre><code>read 1:           ------            
read 2:     -----  
read 3:    ----
      chr1 ATGCTAGCTGATCGTAGCTG...
Coverage   12221101111110000000

chrom start end value
chr1  0  1  1
chr1  1  4  2
chr1  4  6  1
chr1  7 13  1</code></pre>
</div>
</div>
<div id="exploring-chip-seq-data" class="section level1">
<h1 class="hasAnchor">
<a href="#exploring-chip-seq-data" class="anchor"></a>Exploring ChIP-Seq Data</h1>
<div id="simplified-sequencing-analysis-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#simplified-sequencing-analysis-workflow" class="anchor"></a>Simplified sequencing analysis workflow</h2>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Step</th>
<th>File Format</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Get read sequences</td>
<td><a href="https://en.wikipedia.org/wiki/FASTQ_format"><code>FASTQ</code></a></td>
<td>Sequencing Reads</td>
</tr>
<tr class="even">
<td>Align to genome</td>
<td><a href="http://samtools.github.io/hts-specs/SAMv1.pdf"><code>BAM/SAM</code></a></td>
<td>
<strong>S</strong>equence <strong>A</strong>lignment <strong>M</strong>ap Alignment information for each read (BAM = binary file)</td>
</tr>
<tr class="odd">
<td>Summarize Coverage</td>
<td><a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1.8"><code>bedGraph/bigWig</code></a></td>
<td>Count number of reads covering every position in genome i.e. read coverage (bigWig = binary file)</td>
</tr>
<tr class="even">
<td>Define enriched regions</td>
<td><a href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1"><code>BED</code></a></td>
<td>Find regions with enriched coverage. i.e.(“Peaks” of signal)</td>
</tr>
</tbody>
</table>
<p><img src="img/class-4-alignments.jpg"></p>
</div>
<div id="chip-seq-peaks-in-human-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#chip-seq-peaks-in-human-cells" class="anchor"></a>ChIP-Seq Peaks in Human Cells</h2>
<p>The <a href="https://www.encodeproject.org"><code>ENCODE</code></a> project produced hundreds of <a href="https://en.wikipedia.org/wiki/ChIP-sequencing">ChIP-Seq</a> datasets across dozens of humans cell lines. A compendium of ChIP-Seq experiments from 161 DNA-binding proteins were aggregated into a single BED file, available from the UCSC genome browser. We will use this dataset (see <a href="http://genome.ucsc.edu/cgi-bin/hgTables?db=hg19&amp;hgta_group=regulation&amp;hgta_track=wgEncodeRegTfbsClusteredV3&amp;hgta_table=wgEncodeRegTfbsClusteredV3&amp;hgta_doSchema=describe+table+schema">description</a>) to explore interval analysis methods.</p>
<p>First we will discuss a few methods for loading the data into R.</p>
</div>
<div id="download-the-data-to-your-computer-using-r" class="section level2">
<h2 class="hasAnchor">
<a href="#download-the-data-to-your-computer-using-r" class="anchor"></a>Download the data to your computer using R</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">url &lt;-<span class="st"> "http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeRegTfbsClustered/wgEncodeRegTfbsClusteredV3.bed.gz"</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">download.file</span>(url, <span class="st">"wgEncodeRegTfbsClusteredV3.bed.gz"</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">tf_bed &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">"wgEncodeRegTfbsClusteredV3.bed.gz"</span>, </a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                   <span class="dt">col_names =</span> F)</a></code></pre></div>
</div>
<div id="load-the-data-into-memory-directly-from-url-link" class="section level2">
<h2 class="hasAnchor">
<a href="#load-the-data-into-memory-directly-from-url-link" class="anchor"></a>Load the data into memory directly from url link</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">url &lt;-<span class="st"> "http://hgdownload.cse.ucsc.edu/goldenPath/hg19/encodeDCC/wgEncodeRegTfbsClustered/wgEncodeRegTfbsClusteredV3.bed.gz"</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">tf_bed &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(url, <span class="dt">col_names =</span> F)</a></code></pre></div>
</div>
<div id="load-data-from-file-that-is-included-in-eda-package" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data-from-file-that-is-included-in-eda-package" class="anchor"></a>Load data from file that is included in eda package</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">library</span>(eda)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">file_name &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                         <span class="st">"wgEncodeRegTfbsClusteredV3.bed.gz"</span>, </a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                         <span class="dt">package =</span> <span class="st">"eda"</span>)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">tf_bed &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(file_name, <span class="dt">col_names =</span> F)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">tf_bed</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; # A tibble: 4,380,444 x 4</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;    X1        X2     X3 X4    </span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;    &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;  1 chr1   10073  10329 ZBTB33</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt;  2 chr1   10149  10413 CEBPB </span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt;  3 chr1   16110  16390 CTCF  </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt;  4 chr1   29198  29688 TAF1  </span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt;  5 chr1   29275  29591 GABPA </span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt;  6 chr1   89795  90051 USF1  </span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt;  7 chr1   91156  91580 CTCF  </span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt;  8 chr1  104859 105089 CTCF  </span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt;  9 chr1  138850 139274 CTCF  </span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; 10 chr1  235541 235877 SP1   </span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; # ... with 4,380,434 more rows</span></a></code></pre></div>
</div>
<div id="fixing-column-names" class="section level2">
<h2 class="hasAnchor">
<a href="#fixing-column-names" class="anchor"></a>Fixing column names</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">new_names &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  <span class="st">"chrom"</span>,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  <span class="st">"start"</span>,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="st">"end"</span>,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="st">"TF"</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="kw">colnames</span>(tf_bed) &lt;-<span class="st"> </span>new_names</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">tf_bed</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; # A tibble: 4,380,444 x 4</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;    chrom  start    end TF    </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;    &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;  1 chr1   10073  10329 ZBTB33</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;  2 chr1   10149  10413 CEBPB </span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;  3 chr1   16110  16390 CTCF  </span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;  4 chr1   29198  29688 TAF1  </span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt;  5 chr1   29275  29591 GABPA </span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt;  6 chr1   89795  90051 USF1  </span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt;  7 chr1   91156  91580 CTCF  </span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt;  8 chr1  104859 105089 CTCF  </span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt;  9 chr1  138850 139274 CTCF  </span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; 10 chr1  235541 235877 SP1   </span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt; # ... with 4,380,434 more rows</span></a></code></pre></div>
</div>
</div>
<div id="in-class-exercises" class="section level1">
<h1 class="hasAnchor">
<a href="#in-class-exercises" class="anchor"></a>In class exercises</h1>
<ol style="list-style-type: decimal">
<li>Which TF has the most binding-sites (AKA peaks)?</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">group_by</span>(tf_bed, TF) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">total =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(total)) </a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; # A tibble: 161 x 2</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;    TF      total</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt;  1 CTCF   162209</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;  2 CEBPB  146873</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt;  3 EP300  138836</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt;  4 POLR2A 134990</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt;  5 FOS    131528</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt;  6 RAD21  119039</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt;  7 JUND    97411</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt;  8 MYC     96959</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt;  9 FOXA1   89906</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; 10 MAX     85949</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#&gt; # ... with 151 more rows</span></a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Which TF covers the most basepairs in the genome?</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">mutate</span>(tf_bed, </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">       <span class="dt">peak_length =</span> end <span class="op">-</span><span class="st"> </span>start) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(TF) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">total_bps =</span> <span class="kw">sum</span>(peak_length)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(total_bps)) </a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; # A tibble: 161 x 2</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt;    TF     total_bps</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;    &lt;chr&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt;  1 POLR2A  89294720</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt;  2 CTCF    58703098</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt;  3 EP300   48927186</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt;  4 CEBPB   40528940</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt;  5 FOS     40220836</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt;  6 MYC     37956453</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt;  7 MAX     33399586</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt;  8 JUND    32234838</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt;  9 GATA2   30382649</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt; 10 RAD21   29887860</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; # ... with 151 more rows</span></a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Which TF has the broadest or the narrowest binding-sites on average?</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">mutate</span>(tf_bed, </a>
<a class="sourceLine" id="cb13-2" data-line-number="2">       <span class="dt">peak_length =</span> end <span class="op">-</span><span class="st"> </span>start) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(TF) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_bps =</span> <span class="kw">mean</span>(peak_length)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean_bps))</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; # A tibble: 161 x 2</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt;    TF      mean_bps</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;    &lt;chr&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt;  1 EZH2        983.</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt;  2 ZNF274      894.</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt;  3 RBBP5       763.</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt;  4 KAP1        755.</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt;  5 POLR3G      709.</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt;  6 SETDB1      684.</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt;  7 SMARCA4     683.</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt;  8 SMARCC1     681.</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt;  9 SMARCB1     668.</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt; 10 POLR2A      661.</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#&gt; # ... with 151 more rows</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="kw">mutate</span>(tf_bed, </a>
<a class="sourceLine" id="cb13-22" data-line-number="22">       <span class="dt">peak_length =</span> end <span class="op">-</span><span class="st"> </span>start) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="st">  </span><span class="kw">group_by</span>(TF) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_bps =</span> <span class="kw">mean</span>(peak_length)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-25" data-line-number="25"><span class="st">  </span><span class="kw">arrange</span>(mean_bps)</a>
<a class="sourceLine" id="cb13-26" data-line-number="26"><span class="co">#&gt; # A tibble: 161 x 2</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="co">#&gt;    TF     mean_bps</span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-29" data-line-number="29"><span class="co">#&gt;  1 CTCFL      164.</span></a>
<a class="sourceLine" id="cb13-30" data-line-number="30"><span class="co">#&gt;  2 BATF       210.</span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="co">#&gt;  3 PBX3       210.</span></a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="co">#&gt;  4 FOSL1      214.</span></a>
<a class="sourceLine" id="cb13-33" data-line-number="33"><span class="co">#&gt;  5 POU5F1     214.</span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="co">#&gt;  6 SRF        214.</span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35"><span class="co">#&gt;  7 NFE2       225.</span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36"><span class="co">#&gt;  8 EGR1       238.</span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37"><span class="co">#&gt;  9 NANOG      239.</span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38"><span class="co">#&gt; 10 FAM48A     240.</span></a>
<a class="sourceLine" id="cb13-39" data-line-number="39"><span class="co">#&gt; # ... with 151 more rows</span></a>
<a class="sourceLine" id="cb13-40" data-line-number="40"></a>
<a class="sourceLine" id="cb13-41" data-line-number="41"></a>
<a class="sourceLine" id="cb13-42" data-line-number="42"><span class="kw">mutate</span>(tf_bed, </a>
<a class="sourceLine" id="cb13-43" data-line-number="43">       <span class="dt">peak_length =</span> end <span class="op">-</span><span class="st"> </span>start) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-44" data-line-number="44"><span class="st">  </span><span class="kw">group_by</span>(TF) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-45" data-line-number="45"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_bps =</span> <span class="kw">mean</span>(peak_length)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-46" data-line-number="46"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean_bps)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-47" data-line-number="47"><span class="st">  </span><span class="kw">slice</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(.)))</a>
<a class="sourceLine" id="cb13-48" data-line-number="48"><span class="co">#&gt; # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb13-49" data-line-number="49"><span class="co">#&gt;   TF    mean_bps</span></a>
<a class="sourceLine" id="cb13-50" data-line-number="50"><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-51" data-line-number="51"><span class="co">#&gt; 1 EZH2      983.</span></a>
<a class="sourceLine" id="cb13-52" data-line-number="52"><span class="co">#&gt; 2 CTCFL     164.</span></a></code></pre></div>
</div>
<div id="integrating-multiple-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#integrating-multiple-datasets" class="anchor"></a>Integrating multiple datasets</h1>
<p>We can now use the BED format as a common file to investigate multiple genome-wide datatypes. Imagine that we had two bed files named (<code>x</code> and <code>y</code>). How would we go about finding intervals in <code>x</code> that overlap with <code>y</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">x</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt;   chrom start   end</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 1 chr1     25    50</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 2 chr1     40    80</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 3 chr1    100   125</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8">y</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt;   chrom start   end</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; 1 chr1     30    75</span></a></code></pre></div>
<p>This is not very easy to do with dplyr or base R, and would be very slow.</p>
</div>
<div id="how-to-efficiently-analyze-intervals-and-signals" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-efficiently-analyze-intervals-and-signals" class="anchor"></a>How to efficiently analyze intervals and signals?</h1>
<p>To efficiently query interval data a set of algorithms are used to speed up the querying process. Examples here: <a href="https://en.wikipedia.org/wiki/Interval_tree">Interval Tree</a> or <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0973-5">ChromSweep</a>.</p>
<p>These algorithms have been implemented in a set of tools specific for analyzing genomic interval data.</p>
<div id="command-line-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#command-line-tools" class="anchor"></a>Command-line tools</h2>
<ul>
<li>
<a href="http://bedtools.readthedocs.io/en/latest/"><code>BEDTools</code></a> (the most popular and original tool-suite)</li>
<li>
<a href="https://bedops.readthedocs.io/en/latest/"><code>BedOPS</code></a> (similar to BEDTools but offers some unique functionality)</li>
</ul>
</div>
<div id="r-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#r-packages" class="anchor"></a>R-Packages</h2>
<ul>
<li>
<a href="https://rnabioco.github.io/valr/"><code>valr</code></a> (Interval analysis with a <code>tidyverse</code> style syntax)</li>
<li>
<a href="https://bioconductor.org/packages/release/bioc/html/GenomicRanges.html"><code>GRanges</code></a> (Interval analysis used in many <a href="http://www.bioconductor.org/"><code>BioConductor</code></a> packages)</li>
</ul>
</div>
</div>
<div id="introduction-to-valr" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction-to-valr" class="anchor"></a>Introduction to valr</h1>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">#install.packages("valr")</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">library</span>(valr)</a></code></pre></div>
<p><a href="https://rnabioco.github.io/valr/"><code>valr</code></a> was developed to simplify genomic interval analysis and replace the need for learning the command line. We will use <code>valr</code> today to introduce genomic interval analysis.</p>
<div id="reading-in-bed-data" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-in-bed-data" class="anchor"></a>Reading in BED data</h2>
<p><code>valr</code> assigns common column names to facilitate comparisons between tibbles. All tibbles will have <code>chrom</code>, <code>start</code>, and <code>end</code> columns, and some tibbles from multi-column formats will have additional pre-determined column names. See the <a href="https://rnabioco.github.io/valr/reference/read_bed.html"><code><a href="http://valr.hesselberthlab.org/reference/read_bed.html">read_bed()</a></code></a> documentation for additional details.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># get path to bed file</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">bed_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">                        <span class="st">"6fields.bed.gz"</span>,</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                        <span class="dt">package =</span> <span class="st">"valr"</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co"># read in bed, indicate the number of columns with n_fields</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">bed &lt;-<span class="st"> </span><span class="kw"><a href="http://valr.hesselberthlab.org/reference/read_bed.html">read_bed</a></span>(bed_file, <span class="dt">n_fields =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb16-9" data-line-number="9"></a>
<a class="sourceLine" id="cb16-10" data-line-number="10">bed</a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#&gt; # A tibble: 10 x 6</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#&gt;    chrom  start    end name         score strand</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">#&gt;    &lt;chr&gt;  &lt;int&gt;  &lt;int&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#&gt;  1 chr1   11873  14409 DDX11L1      3     +     </span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">#&gt;  2 chr1   14361  19759 WASH7P       10    -     </span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">#&gt;  3 chr1   14406  29370 WASH7P       7     -     </span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="co">#&gt;  4 chr1   34610  36081 FAM138F      3     -     </span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="co">#&gt;  5 chr1   69090  70008 OR4F5        1     +     </span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="co">#&gt;  6 chr1  134772 140566 LOC729737    3     -     </span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="co">#&gt;  7 chr1  321083 321115 DQ597235     1     +     </span></a>
<a class="sourceLine" id="cb16-21" data-line-number="21"><span class="co">#&gt;  8 chr1  321145 321207 DQ599768     1     +     </span></a>
<a class="sourceLine" id="cb16-22" data-line-number="22"><span class="co">#&gt;  9 chr1  322036 326938 LOC100133331 3     +     </span></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"><span class="co">#&gt; 10 chr1  327545 328439 LOC388312    1     +</span></a></code></pre></div>
</div>
<div id="find-intersecting-intervals-with-bed_intersect" class="section level2">
<h2 class="hasAnchor">
<a href="#find-intersecting-intervals-with-bed_intersect" class="anchor"></a>Find intersecting intervals with bed_intersect()</h2>
<p>One of the most common operations in interval analysis is to determine if intervals in 1 BED file overlap with intervals in another file. This operation can be used to answer many questions including:</p>
<ol style="list-style-type: decimal">
<li>Does a SNP overlap with a protein-coding region?</li>
<li>Which genes does a transcription factor bind to?</li>
<li>Does an RNA binding protein bind to 3’UTRs?</li>
</ol>
<p>The <a href="https://rnabioco.github.io/valr/reference/bed_intersect.html"><code><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect()</a></code></a> function in valr finds intervals that overlap in two datasets and reports the intersecting intervals.</p>
<p>Imagine that we have a set of two bed files that we have read into R as <code>x</code> and <code>y</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">x</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co">#&gt; # A tibble: 3 x 6</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt;   chrom start   end name  score strand</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt; 1 chr1     25    50 A         0 +     </span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt; 2 chr1     40    80 B         0 -     </span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt; 3 chr1    100   125 C         0 -</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">y</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">#&gt; # A tibble: 1 x 6</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#&gt;   chrom start   end name  score strand</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">#&gt; 1 chr1     30    75 C         0 -</span></a></code></pre></div>
<p>We can find intersecting intervals by passing <code>x</code> ans <code>y</code> to <code><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect()</a></code></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect</a></span>(x, y)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; # A tibble: 2 x 12</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt;   chrom start.x end.x name.x score.x strand.x start.y end.y name.y score.y</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt; 1 chr1       25    50 A            0 +             30    75 C            0</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; 2 chr1       40    80 B            0 -             30    75 C            0</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt; # ... with 2 more variables: strand.y &lt;chr&gt;, .overlap &lt;int&gt;</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="kw"><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect</a></span>(x, y, <span class="dt">suffix =</span> <span class="kw">c</span>(<span class="st">"_xfile"</span>, <span class="st">"_yfile"</span>))</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; # A tibble: 2 x 12</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt;   chrom start_xfile end_xfile name_xfile score_xfile strand_xfile</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; 1 chr1           25        50 A                    0 +           </span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#&gt; 2 chr1           40        80 B                    0 -           </span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; # ... with 6 more variables: start_yfile &lt;dbl&gt;, end_yfile &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">#&gt; #   name_yfile &lt;chr&gt;, score_yfile &lt;dbl&gt;, strand_yfile &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co">#&gt; #   .overlap &lt;int&gt;</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18"></a>
<a class="sourceLine" id="cb18-19" data-line-number="19">x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect</a></span>(y)</a>
<a class="sourceLine" id="cb18-21" data-line-number="21"><span class="co">#&gt; # A tibble: 2 x 12</span></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"><span class="co">#&gt;   chrom start.x end.x name.x score.x strand.x start.y end.y name.y score.y</span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23"><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb18-24" data-line-number="24"><span class="co">#&gt; 1 chr1       25    50 A            0 +             30    75 C            0</span></a>
<a class="sourceLine" id="cb18-25" data-line-number="25"><span class="co">#&gt; 2 chr1       40    80 B            0 -             30    75 C            0</span></a>
<a class="sourceLine" id="cb18-26" data-line-number="26"><span class="co">#&gt; # ... with 2 more variables: strand.y &lt;chr&gt;, .overlap &lt;int&gt;</span></a></code></pre></div>
<p><code>valr</code> functions respect groups established by <code>group_by()</code>. For example to only intersect intervals if they are on the same strand, <code>group_by()</code> strand prior to intersecting.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">group_by</span>(x, strand)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">group_by</span>(y, strand)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw"><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect</a></span>(x, y)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; # A tibble: 1 x 12</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt;   chrom start.x end.x name.x score.x strand.x start.y end.y name.y score.y</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; 1 chr1       40    80 B            0 -             30    75 C            0</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; # ... with 2 more variables: strand.y &lt;chr&gt;, .overlap &lt;int&gt;</span></a></code></pre></div>
<p><code>valr</code> includes many functions for manipulating, comparing, and randomizing interval data. The <a href="https://rnabioco.github.io/valr/reference/index.html">documentation</a> contains a list of all of the available functions.</p>
</div>
<div id="how-many-snps-in-tf-binding-sites" class="section level2">
<h2 class="hasAnchor">
<a href="#how-many-snps-in-tf-binding-sites" class="anchor"></a>How many SNPs in TF binding sites?</h2>
<p>First obtain a bed file of SNPs:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">library</span>(valr)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">snp_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb20-3" data-line-number="3">                        <span class="st">"hg19.snps147.chr22.bed.gz"</span>, </a>
<a class="sourceLine" id="cb20-4" data-line-number="4">                        <span class="dt">package =</span> <span class="st">"valr"</span>)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5"></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">snps &lt;-<span class="st"> </span><span class="kw"><a href="http://valr.hesselberthlab.org/reference/read_bed.html">read_bed</a></span>(snp_file, </a>
<a class="sourceLine" id="cb20-7" data-line-number="7">                 <span class="dt">n_fields =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">snps</a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; # A tibble: 10,000 x 6</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt;    chrom    start      end name        score strand</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt;    &lt;chr&gt;    &lt;int&gt;    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt;  1 chr22 16053247 16053248 rs587721086 0     +     </span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt;  2 chr22 16053443 16053444 rs80167676  0     +     </span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt;  3 chr22 16055964 16055965 rs587706951 0     +     </span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt;  4 chr22 16069373 16069374 rs2154787   0     +     </span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt;  5 chr22 16069782 16069783 rs1963212   0     +     </span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt;  6 chr22 16100513 16100514 rs8140563   0     +     </span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt;  7 chr22 16114622 16114623 rs558374111 0     +     </span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"><span class="co">#&gt;  8 chr22 16115181 16115182 rs567521927 0     +     </span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt;  9 chr22 16115377 16115378 rs538733846 0     +     </span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#&gt; 10 chr22 16121639 16121640 rs544560983 0     +     </span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="co">#&gt; # ... with 9,990 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">snps_in_tfs &lt;-<span class="st"> </span><span class="kw"><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect</a></span>(tf_bed, snps) </a>
<a class="sourceLine" id="cb21-2" data-line-number="2"></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">snps_in_tfs</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt; # A tibble: 8,851 x 10</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;    chrom start.x  end.x TF.x  start.y  end.y name.y score.y strand.y</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;  &lt;int&gt; &lt;chr&gt;   &lt;int&gt;  &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;   </span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt;  1 chr22  1.69e7 1.69e7 CTCF   1.69e7 1.69e7 rs131… 0       +       </span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt;  2 chr22  1.69e7 1.69e7 CTCF   1.69e7 1.69e7 rs575… 0       +       </span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt;  3 chr22  1.69e7 1.69e7 CEBPB  1.69e7 1.69e7 rs575… 0       +       </span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt;  4 chr22  1.69e7 1.69e7 SMC3   1.69e7 1.69e7 rs575… 0       +       </span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt;  5 chr22  1.70e7 1.70e7 NR3C1  1.70e7 1.70e7 rs237… 0       +       </span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt;  6 chr22  1.70e7 1.70e7 TAF1   1.70e7 1.70e7 rs536… 0       +       </span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt;  7 chr22  1.71e7 1.71e7 RBBP5  1.71e7 1.71e7 rs223… 0       +       </span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">#&gt;  8 chr22  1.71e7 1.71e7 MAX    1.71e7 1.71e7 rs223… 0       +       </span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="co">#&gt;  9 chr22  1.71e7 1.71e7 UBTF   1.71e7 1.71e7 rs223… 0       +       </span></a>
<a class="sourceLine" id="cb21-16" data-line-number="16"><span class="co">#&gt; 10 chr22  1.71e7 1.71e7 SAP30  1.71e7 1.71e7 rs223… 0       +       </span></a>
<a class="sourceLine" id="cb21-17" data-line-number="17"><span class="co">#&gt; # ... with 8,841 more rows, and 1 more variable: .overlap &lt;int&gt;</span></a></code></pre></div>
</div>
<div id="how-close-are-snps-to-transcription-start-sites" class="section level2">
<h2 class="hasAnchor">
<a href="#how-close-are-snps-to-transcription-start-sites" class="anchor"></a>How close are SNPs to transcription start sites?</h2>
<p>The <a href="https://rnabioco.github.io/valr/reference/bed_intersect.html"><code><a href="http://valr.hesselberthlab.org/reference/bed_closest.html">bed_closest()</a></code></a> function finds the closest intervals between two sets of intervals.</p>
<p>First read in a BED file that contains genes in the human genome (hg19 build).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">gene_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb22-2" data-line-number="2">                        <span class="st">"hg19_genes.bed.gz"</span>, </a>
<a class="sourceLine" id="cb22-3" data-line-number="3">                        <span class="dt">package =</span> <span class="st">"eda"</span>)</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">genes &lt;-<span class="st"> </span><span class="kw"><a href="http://valr.hesselberthlab.org/reference/read_bed.html">read_bed</a></span>(gene_file, </a>
<a class="sourceLine" id="cb22-6" data-line-number="6">                 <span class="dt">n_fields =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">genes</a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; # A tibble: 55,006 x 6</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">#&gt;    chrom start   end name         score strand</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">#&gt;    &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="co">#&gt;  1 chr1  11868 14362 LOC102725121 3     +     </span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="co">#&gt;  2 chr1  11873 14409 DDX11L1      3     +     </span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="co">#&gt;  3 chr1  14361 29370 WASH7P       11    -     </span></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="co">#&gt;  4 chr1  17368 17436 MIR6859-1    1     -     </span></a>
<a class="sourceLine" id="cb22-15" data-line-number="15"><span class="co">#&gt;  5 chr1  17368 17436 MIR6859-2    1     -     </span></a>
<a class="sourceLine" id="cb22-16" data-line-number="16"><span class="co">#&gt;  6 chr1  17368 17436 MIR6859-3    1     -     </span></a>
<a class="sourceLine" id="cb22-17" data-line-number="17"><span class="co">#&gt;  7 chr1  17368 17436 MIR6859-4    1     -     </span></a>
<a class="sourceLine" id="cb22-18" data-line-number="18"><span class="co">#&gt;  8 chr1  30365 30503 MIR1302-2    1     +     </span></a>
<a class="sourceLine" id="cb22-19" data-line-number="19"><span class="co">#&gt;  9 chr1  30365 30503 MIR1302-9    1     +     </span></a>
<a class="sourceLine" id="cb22-20" data-line-number="20"><span class="co">#&gt; 10 chr1  30365 30503 MIR1302-10   1     +     </span></a>
<a class="sourceLine" id="cb22-21" data-line-number="21"><span class="co">#&gt; # ... with 54,996 more rows</span></a></code></pre></div>
<p>Next we’ll generate a set of transcription start sites for each gene. The start site depends on the strand of the interval. Here for simplicity we will only look at intervals from the plus strand. If you want to keep the minus strand you need to use <code>ifelse()</code> in the <code>mutate()</code> call to conditionally define the start and end based on strand.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">tss &lt;-<span class="st"> </span><span class="kw">filter</span>(genes, strand <span class="op">==</span><span class="st"> "+"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">end =</span> start <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">              </a>
<a class="sourceLine" id="cb23-4" data-line-number="4">tss</a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; # A tibble: 28,035 x 6</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">#&gt;    chrom  start    end name         score strand</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt;    &lt;chr&gt;  &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="co">#&gt;  1 chr1   11868  11869 LOC102725121 3     +     </span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt;  2 chr1   11873  11874 DDX11L1      3     +     </span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt;  3 chr1   30365  30366 MIR1302-2    1     +     </span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt;  4 chr1   30365  30366 MIR1302-9    1     +     </span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt;  5 chr1   30365  30366 MIR1302-10   1     +     </span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt;  6 chr1   30365  30366 MIR1302-11   1     +     </span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt;  7 chr1   69090  69091 OR4F5        1     +     </span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt;  8 chr1  323891 323892 LOC100132287 3     +     </span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">#&gt;  9 chr1  323891 323892 LOC100132062 3     +     </span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt; 10 chr1  323891 323892 LOC100133331 4     +     </span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="co">#&gt; # ... with 28,025 more rows</span></a></code></pre></div>
<p>Lastly, we will use the <code><a href="http://valr.hesselberthlab.org/reference/bed_closest.html">bed_closest()</a></code> tool to find the closest <code>TSS</code> to each <code>SNP</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="http://valr.hesselberthlab.org/reference/bed_closest.html">bed_closest</a></span>(snps, tss) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(chrom<span class="op">:</span>strand.x, name.y, .overlap, .dist)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt; # A tibble: 14,019 x 9</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt;    chrom  start.x   end.x name.x   score.x strand.x name.y .overlap  .dist</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;    &lt;int&gt;   &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">#&gt;  1 chr22 16053247  1.61e7 rs58772… 0       +        BMS1P…        0 103831</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">#&gt;  2 chr22 16053443  1.61e7 rs80167… 0       +        BMS1P…        0 103635</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">#&gt;  3 chr22 16055964  1.61e7 rs58770… 0       +        BMS1P…        0 101114</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">#&gt;  4 chr22 16069373  1.61e7 rs21547… 0       +        BMS1P…        0  87705</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">#&gt;  5 chr22 16069782  1.61e7 rs19632… 0       +        BMS1P…        0  87296</span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">#&gt;  6 chr22 16100513  1.61e7 rs81405… 0       +        BMS1P…        0  56565</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">#&gt;  7 chr22 16114622  1.61e7 rs55837… 0       +        BMS1P…        0  42456</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">#&gt;  8 chr22 16115181  1.61e7 rs56752… 0       +        BMS1P…        0  41897</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="co">#&gt;  9 chr22 16115377  1.61e7 rs53873… 0       +        BMS1P…        0  41701</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="co">#&gt; 10 chr22 16121639  1.61e7 rs54456… 0       +        BMS1P…        0  35439</span></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"><span class="co">#&gt; # ... with 14,009 more rows</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17"></a>
<a class="sourceLine" id="cb24-18" data-line-number="18"><span class="kw"><a href="http://valr.hesselberthlab.org/reference/bed_closest.html">bed_closest</a></span>(snps, tss) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-19" data-line-number="19"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">abs</span>(.dist) <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-20" data-line-number="20"><span class="st">  </span><span class="kw">select</span>(chrom<span class="op">:</span>strand.x, name.y, .overlap, .dist)</a>
<a class="sourceLine" id="cb24-21" data-line-number="21"><span class="co">#&gt; # A tibble: 14 x 9</span></a>
<a class="sourceLine" id="cb24-22" data-line-number="22"><span class="co">#&gt;    chrom  start.x   end.x name.x  score.x strand.x name.y   .overlap .dist</span></a>
<a class="sourceLine" id="cb24-23" data-line-number="23"><span class="co">#&gt;    &lt;chr&gt;    &lt;int&gt;   &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;       &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb24-24" data-line-number="24"><span class="co">#&gt;  1 chr22 21043817  2.10e7 rs3730… 0       +        POM121L…        0    25</span></a>
<a class="sourceLine" id="cb24-25" data-line-number="25"><span class="co">#&gt;  2 chr22 21319416  2.13e7 rs1120… 0       +        AIFM3           0     1</span></a>
<a class="sourceLine" id="cb24-26" data-line-number="26"><span class="co">#&gt;  3 chr22 21319416  2.13e7 rs1120… 0       +        AIFM3           0     1</span></a>
<a class="sourceLine" id="cb24-27" data-line-number="27"><span class="co">#&gt;  4 chr22 23229961  2.32e7 rs6003… 0       +        IGLL5           0    -2</span></a>
<a class="sourceLine" id="cb24-28" data-line-number="28"><span class="co">#&gt;  5 chr22 23229961  2.32e7 rs6003… 0       +        IGLL5           0    -2</span></a>
<a class="sourceLine" id="cb24-29" data-line-number="29"><span class="co">#&gt;  6 chr22 25423930  2.54e7 rs1191… 0       +        KIAA1671        0    10</span></a>
<a class="sourceLine" id="cb24-30" data-line-number="30"><span class="co">#&gt;  7 chr22 26908525  2.69e7 rs1473… 0       +        LOC1005…        0   -28</span></a>
<a class="sourceLine" id="cb24-31" data-line-number="31"><span class="co">#&gt;  8 chr22 31090785  3.11e7 rs7971… 0       +        OSBP2           0     7</span></a>
<a class="sourceLine" id="cb24-32" data-line-number="32"><span class="co">#&gt;  9 chr22 38005057  3.80e7 rs1305… 0       +        GGA1            0   -11</span></a>
<a class="sourceLine" id="cb24-33" data-line-number="33"><span class="co">#&gt; 10 chr22 38142198  3.81e7 rs1179… 0       +        TRIOBP          0    42</span></a>
<a class="sourceLine" id="cb24-34" data-line-number="34"><span class="co">#&gt; 11 chr22 38142198  3.81e7 rs1179… 0       +        TRIOBP          0    42</span></a>
<a class="sourceLine" id="cb24-35" data-line-number="35"><span class="co">#&gt; 12 chr22 38203871  3.82e7 rs5995… 0       +        GCAT            0    40</span></a>
<a class="sourceLine" id="cb24-36" data-line-number="36"><span class="co">#&gt; 13 chr22 38203871  3.82e7 rs5995… 0       +        GCAT            0    40</span></a>
<a class="sourceLine" id="cb24-37" data-line-number="37"><span class="co">#&gt; 14 chr22 46156445  4.62e7 rs6030… 0       +        MIR4762         0   -42</span></a></code></pre></div>
</div>
</div>
<div id="exercises" class="section level1">
<h1 class="hasAnchor">
<a href="#exercises" class="anchor"></a>Exercises</h1>
<ol style="list-style-type: decimal">
<li><p>The Encode project has performed <code>eCLIP</code> experiments to map RNA binding protein (RBP) binding sites for &gt; 100 RBPs. Go to the <a href="https://www.encodeproject.org/matrix/?type=Experiment">Encode website</a>, search for <code>eCLIP</code> experiments, select an RBP eClip experiment, and load a <code>BED</code> file (bed narrowPeak format) with the binding sites into R using just the url. Use the <a href="https://rnabioco.github.io/valr/reference/read_bed.html"><code>read_narrowPeak()</code></a> function from <code>valr</code>. Make sure that the file was generated using the <code>hg19</code> genome build, and that you do <strong>not</strong> select the <code>eCLIP mock input</code> samples, which are negative controls. Display the bed tibble that you pulled from the Encode database and give a one to two sentence summary about the known functions of the RBP.</p></li>
<li><p>Use <code><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect()</a></code> and some dplyr functions to determine how many <code>eCLIP</code> peaks are found in genes and how many are intergenic. (see the documentation on the <code>invert</code> argument for <code><a href="http://valr.hesselberthlab.org/reference/bed_intersect.html">bed_intersect()</a></code>). Use the <code>hg19_genes.bed.gz</code> bed file as your gene bed file (location shown below). Explain in the interpretation whether or not the RBP primarily binds to known (geneic) or unannotated (intergeneic) regions.</p></li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">genes &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"hg19_genes.bed.gz"</span>, <span class="dt">package =</span> <span class="st">"eda"</span>)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw"><a href="http://valr.hesselberthlab.org/reference/read_bed.html">read_bed</a></span>(genes, <span class="dt">n_fields =</span> <span class="dv">6</span>)</a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>Parse the output from question 2 to determine which gene has the most binding sites for your <code>RBP</code>.</p></li>
<li><p>Use another function from <code>valr</code> (overview and documentation <a href="https://rnabioco.github.io/valr/articles/valr.html">here</a> to study a relationship between your eClip binding sites and genes in the <code>gene</code> bed file. Explain your question and answer. Some <code>valr</code> functions require a <code>genome</code> file, which indicates the lengths of the chromosomes.You can access this file as shown below.</p></li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">genome_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"hg19_genome.txt.gz"</span>, <span class="dt">package =</span> <span class="st">"eda"</span>)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">genome &lt;-<span class="st"> </span><span class="kw"><a href="http://valr.hesselberthlab.org/reference/read_genome.html">read_genome</a></span>(genome_file)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"></a>
<a class="sourceLine" id="cb26-4" data-line-number="4">genome</a></code></pre></div>
</div>
<div id="quiz" class="section level1">
<h1 class="hasAnchor">
<a href="#quiz" class="anchor"></a>Quiz</h1>
<p>Create an RMarkdown document and answer the questions from the Exercises section. Write your answers in the text, and print the final tibbles that your code produced that gave you the answer. Submit your final document as “Quiz 3” by Friday at 10 PM.</p>
<p><strong>Your submitted document must knit to HTML without errors</strong>. I.e., when you click the “Knit” button, the document should build and display and HTML page.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#genomic-interval-data">Genomic Interval Data</a></li>
      <li><a href="#visualizing-genomics-data-with-the-ucsc-genome-browser">Visualizing genomics data with the UCSC genome browser</a></li>
      <li>
<a href="#genomics-data-summarizes-to-intervals">Genomics data summarizes to intervals</a><ul class="nav nav-pills nav-stacked">
<li><a href="#nucleotides-are-represented-in-1-d-positional-coordinates">Nucleotides are represented in 1-D positional coordinates:</a></li>
      <li><a href="#intervals-describe-regions">Intervals describe regions</a></li>
      <li><a href="#read-alignments-are-intervals">Read alignments are intervals</a></li>
      </ul>
</li>
      <li><a href="#bed-format">BED format</a></li>
      <li>
<a href="#obtaining-interval-data">Obtaining interval data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#bedgraph-files-define-genomic-signals">Bedgraph files define genomic signals</a></li>
      </ul>
</li>
      <li>
<a href="#exploring-chip-seq-data">Exploring ChIP-Seq Data</a><ul class="nav nav-pills nav-stacked">
<li><a href="#simplified-sequencing-analysis-workflow">Simplified sequencing analysis workflow</a></li>
      <li><a href="#chip-seq-peaks-in-human-cells">ChIP-Seq Peaks in Human Cells</a></li>
      <li><a href="#download-the-data-to-your-computer-using-r">Download the data to your computer using R</a></li>
      <li><a href="#load-the-data-into-memory-directly-from-url-link">Load the data into memory directly from url link</a></li>
      <li><a href="#load-data-from-file-that-is-included-in-eda-package">Load data from file that is included in eda package</a></li>
      <li><a href="#fixing-column-names">Fixing column names</a></li>
      </ul>
</li>
      <li><a href="#in-class-exercises">In class exercises</a></li>
      <li><a href="#integrating-multiple-datasets">Integrating multiple datasets</a></li>
      <li>
<a href="#how-to-efficiently-analyze-intervals-and-signals">How to efficiently analyze intervals and signals?</a><ul class="nav nav-pills nav-stacked">
<li><a href="#command-line-tools">Command-line tools</a></li>
      <li><a href="#r-packages">R-Packages</a></li>
      </ul>
</li>
      <li>
<a href="#introduction-to-valr">Introduction to valr</a><ul class="nav nav-pills nav-stacked">
<li><a href="#reading-in-bed-data">Reading in BED data</a></li>
      <li><a href="#find-intersecting-intervals-with-bed_intersect">Find intersecting intervals with bed_intersect()</a></li>
      <li><a href="#how-many-snps-in-tf-binding-sites">How many SNPs in TF binding sites?</a></li>
      <li><a href="#how-close-are-snps-to-transcription-start-sites">How close are SNPs to transcription start sites?</a></li>
      </ul>
</li>
      <li><a href="#exercises">Exercises</a></li>
      <li><a href="#quiz">Quiz</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://hesselberthlab.org">Jay Hesselberth</a>, Austin Gillen, Kent Riemondy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
